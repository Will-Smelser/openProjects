(function($){jQuery.fn.uiselect=function(q,r){if(typeof q==='undefined')q='ui-select';if(q==='widget')return $(this).parent().find('input').autocomplete('widget');if(q.match(/^(autocomplete)/))if(typeof r==='function')return $(this).parent().find('input').on(q,r);else return $(this).parent().find('input').autocomplete(r);return this.each(function(i,j){switch(q){case'refresh':break;default:var k=$(document.createElement('div')).addClass(q);var l=$(document.createElement('span')).addClass('ui-spinner ui-widget ui-widget-content ui-corner-all');var m=$(document.createElement('input'));var n=$(document.createElement('a')).addClass('ui-spinner-button ui-spinner-down ui-state-default ui-corner-right');var o=$(document.createElement('span')).addClass('ui-button-text');var p=$(document.createElement('span')).addClass('ui-icon ui-icon-triangle-1-s');n.append(o.append(p));$(this).wrap(k);$(this).before(l.append(m).append(n))}$(this).each(function(){var c=[];var d=$(this).hide();d.children().each(function(){c.push({label:$(this).html(),value:$(this).attr('value')})});var e=d.siblings().find('input').val(d.find(':selected').text());if(q==='refresh')e.autocomplete('destroy');e.autocomplete({source:c,delay:0,minLength:0});var f=function(){e.autocomplete("search","");e.focus();d.trigger('click')};d.siblings().find('a.ui-spinner-button').click(f);e.click(f).on("autocompleteselect",function(a,b){if(b.item.value!=d.val()){e.val(b.item.label);d.val(b.item.value);d.trigger('change')}return false});var g=true;var h=function(a){$(this).val(d.find(':selected').html());if(a.keyCode==13||a.keyCode==27){g=true;return}if((a.keyCode==38||a.keyCode==40)){if(g)g=false;else{return}}e.autocomplete("search","")};e.keydown(h).keyup(h).keypress(h)})})}})(jQuery);